<ng-template #template let-items>
    <ul class="list-disc text-sm ml-4 mt-2">
        <ng-container *ngFor="let item of items">
            <li *ngIf="item.visible">
                <ng-container *ngTemplateOutlet="nodeTemplate; context: { $implicit: item }">
                </ng-container>
                <ng-container *ngIf="item.children && item.children.length > 0 && item.expanded">
                    <ng-container *ngTemplateOutlet="template; context: { $implicit: item.children }">
                    </ng-container>
                </ng-container>
            </li>
        </ng-container>
    </ul>
</ng-template>

<ng-container *ngIf="items">
    <ng-container *ngTemplateOutlet="template; context: { $implicit: items }"></ng-container>
</ng-container>